<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>PiSproDB</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- <link href="nouislider.min.css" rel="stylesheet"> -->
        <link href="toggle-switch.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="stylesheet.css">
        <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    </head>

    <body style="background-color:#37474f ;">

        <nav class="navbar navbar-inverse">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>                        
                    </button>
                    <a class="navbar-brand" href="#">PiSproDB</a>
                </div>
                <div class="collapse navbar-collapse" id="myNavbar">
                    <ul class="nav navbar-nav">
                        <li><a href="index.html">Home</a></li>
                        <li class="active"><a href="brew.html">Brew</a></li>
                        <li><a href="ReplayShot.html">Replay Shot</a></li>
                        <li><a href="#">Settings</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <!--- Gauges ----->
        <script type="text/javascript">
            google.charts.load('current', {'packages':['gauge']});
            google.charts.setOnLoadCallback(drawChart);

            
                
            function getData() {
                var baseURL = "http://pidataspro.ddns.net:8056/";
                var ambientTemp = [], boilerTemp=[],ambientHumidity=[];
                var all = [];
                $.getJSON(baseURL.concat("getLastNormal"), function(results){
                    
                    
                    $.each(results, function(i, field){
                        ambientTemp.push(field.ambientTemp);
                        boilerTemp.push(field.boilerTemp);
                        ambientHumidity.push(field.ambientHumidity);
                    });
                    
                    
            });
                //all = [ambientTemp[0],boilerTemp[0],ambientHumidity[0]];
                all = [1,2,3];
                return all;
            }
            function drawChart() {
                
                    var all = getData();
                    var data = google.visualization.arrayToDataTable([
                        ['Label', 'Value'],
                        ['Boiler Temp', all[0]],
                        ['Room Temp', all[1]],
                        ['Humidity', all[2]]
                    ]);

                    var options = {
                        width: 700, height: 300,
                        redFrom: 90, redTo: 100,
                        yellowFrom:75, yellowTo: 90,
                        minorTicks: 5
                    };

                    var chart = new google.visualization.Gauge(document.getElementById('chart_div'));

                    chart.draw(data, options);

                    setInterval(function() {
                        //drawChart();
                       // data.setValue(0, 1, boilerTemp[0]);
                        //chart.draw(data, options);
                    }, 2000);
                    setInterval(function() {
                        //data.setValue(1, 1, ambientTemp[0]);
                        ///chart.draw(data, options);
                    }, 1000);
                    setInterval(function() {
                    //    data.setValue(2, 1, ambientHumidity[0]);
                    //    chart.draw(data, options);
                    }, 1000);

                        
                }
        </script>
        <body>
            <div id="chart_div" style="width: 700px; height: 300px;"></div>
        </body>

        <!---Temp Chart--->
        <div class="container-fluid">
            <canvas id="brewTempChart"></canvas>
            <body>
                <script>
                    var ctx = document.getElementById("brewTempChart").getContext("2d");
                    var baseURL = "http://pidataspro.ddns.net:8056/";
                    ctx.fillStyle = "white"

                    function drawRealTempChart() {
                        $.getJSON(baseURL.concat("shot_data"), function(results){
                            var label1 = [], boilerTemp=[],roomTemp=[];
                            $.each(results, function(i, field){
                                label1.push(field.timeStamp);
                                boilerTemp.push(field.boilerTemp);
                            });

                            var tempData = {
                                labels: label1,
                                xAxisID: "Time",
                                yAxisID: "Temperature in F",
                                datasets : [{
                                    label: 'Boiler Temperature',
                                    backgroundColor: "rgba(153,255,51,0.4)",
                                    data: boilerTemp,
                                    radius: 2,
                                    fill: false
                                }]
                            };


                            var brewTempChart = new Chart(ctx, {
                                type: 'line',
                                data: tempData,
                                options:{
                                    animation:{
                                        duration: 0
                                    },
                                    title: {
                                        fontSize: 20,
                                        display: true,
                                        text: "Boiler Temperature"},

                                    scales: {
                                        yAxes: [{
                                            ticks: {
                                                stepSize: 20
                                            }
                                        }]

                                    }


                                }
                            });
                        });
                    }
                    drawRealTempChart();
                </script> 
            </body>
        </div>
        <!---Pressure Chart--->
        <div class="container-fluid">
            <canvas id="brewPressureChart"></canvas>
            <body>
                <script>
                    var cpx = document.getElementById("brewPressureChart").getContext("2d");
                    var baseURL = "http://pidataspro.ddns.net:8056/";
                    cpx.fillStyle = "white"

                    function drawRealPressureChart() {
                        $.getJSON(baseURL.concat("shot_data"), function(results){
                            var label2 = [], pressure=[];
                            $.each(results, function(i, field){
                                label2.push(field.timeStamp);
                                pressure.push(field.pressure);
                            });

                            var pressureData = {
                                labels: label2,
                                xAxisID: "Time",
                                yAxisID: "Pressure in Bar",
                                datasets : [{
                                    label: 'Pressure',
                                    backgroundColor: "rgba(153,255,51,0.4)",
                                    data: pressure,
                                    radius: 2,
                                    fill: false
                                }]
                            };


                            var brewPressureChart = new Chart(cpx, {
                                type: 'line',
                                data: pressureData,
                                options:{
                                    animation:{
                                        duration: 0
                                    },
                                    title: {
                                        fontSize: 20,
                                        display: true,
                                        text: "Pressure"},

                                    scales: {
                                        yAxes: [{
                                            ticks: {
                                                stepSize: 1
                                            }
                                        }]

                                    }


                                }
                            });
                        });
                    }
                    drawRealPressureChart();
                </script> 
            </body>
        </div>
        <script>
            //setInterval(function(){
            //    drawRealPressureChart();
            //    drawRealTempChart();
            //}, 1000);    
        </script>
        <!-- <div class="col-md-6">
<h2 id="header" style="color:white ;"></h2>

<!-- Button for Off, pre-infusion, boil -->
        <!--    <div class="switch-toggle switch-3 switch-candy">
<input id="on" name="state-d" type="radio" checked="checked">
<label for="on" onclick="">Off</label>

<input id="na" name="state-d" type="radio">
<label for="na" onclick="">Pre-Infusion</label>

<input id="off" name="state-d" type="radio">
<label for="off" onclick="">Boiling</label>
<a></a>
</div>--->
        <!-- end -->

        <!-- Timer -->
        <!--<div id="timer">
<h3 class="timer">Timer</h3>
<!-- <span class="timer" id="hours">00:</span> -->
        <!-- <span class="timer" id="mins">00:</span> -->
        <!--<span class="timer" id="seconds">00</span>
<span class="timer"> sec </span>  
</div>
<div id="controls">
<button id="start">Start</button>
<button id="stop">Stop</button>
<button id="reset">Reset</button>
</div>

<script>
var hours =0;
var mins =0;
var seconds =0;

$('#start').click(function(){
startTimer();
});

$('#stop').click(function(){
clearTimeout(timex);
});

$('#reset').click(function(){
hours =0;      mins =0;      seconds =0;
$('#hours','#mins').html('00:');
$('#seconds').html('00');
});

function startTimer(){
timex = setTimeout(function(){
seconds++;
if(seconds >59){seconds=0;mins++;
if(mins>59) {
mins=0;hours++;
if(hours <10) {$("#hours").text('0'+hours+':')} else $("#hours").text(hours+':');
}

if(mins<10){                     
$("#mins").text('0'+mins+':');}       
else $("#mins").text(mins+':');
}    
if(seconds <10) {
$("#seconds").text('0'+seconds);} else {
$("#seconds").text(seconds);
}


startTimer();
},1000);
}


</script> --->
        <!-- timer end -->



        <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script src="/socket.io/socket.io.js"></script>
        <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
        <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
        <!-- // <script src="https://github.com/seiyria/bootstrap-slider/tree/master/distbootstrap-slider.min.js"></script> -->
        <script>



        </script>
    </body>
</html>




